---
published: false
---

# 为什么我依然不看好MongoDB

MongoDB已经火了很多年了，虽然被很多人[轮番黑了好多次][1]，但依然继续火。经过一两次的尝试，如今依然不看好。由于领域限制，本文主要阐述OLTP领域的需求，这其实也是MongoDB想要有所发展的领域。MongoDB优点不少，先谈缺点。

### 事务，事务
的确，事务不是必须的，流行的互联网应用似乎如此，发送残缺的聊天短讯其实无伤大雅，有人很早就认识到这一点了，MyISAM就不支持事务但依然活的滋润；但事务仍然是非常重要的，如果你要转账Q币就有问题了。后来，MySQL也认识到这一点了，5.6之后的MySQL将默认引擎切换为InnoDB。

没有事务性支持，所有与钱相关的，电子商务网站、支付类、金融类、连VIP会员积分系统都看不上这玩意儿，没有事务支持怎么玩。这不仅是MongoDB独有的问题，NoSQL领域大多数选手都有这个问题。但区别于Mongo的是，其他NoSQL有其专属领域，如「缓存」、「搜索」等。

我知道，有一些诸如[两段提交这种Hack方式][2]来使之支持「事务」，不过你确定这好使。另外，子事务呢？

### 范式，不要范式
第一次使用MongoDB的时候，使用JSON做为数据结构让人眼前一亮，尤其适合快速迭代的Web开发模式。

使用冗余而不是范式，并强调反范式设计。「数据处女座」，对数据有洁癖的童鞋们，当你们在代码里使用「中文字符串匹配」来设计逻辑时，不知有何感想。

### 查询是否真的更快
当然，关联查询不是快慢问题，而是能不能做的问题，我们就不说了。数据量稍微大一点，个人感觉对于MySQL、Postgres等，并不具备很强的优势，何况真的不能join。

不能Join带来了什么问题，事实上OLTP编程中，并不推荐在交易事务中使用JOIN查询，这会大大降低处理性能，但事后的分析

大量的BI工具依赖传统的SQL模型，这一点上，MongoDB生态有待建设。

### 不安全更光荣？
默认居然是「非安全」模式，官方以此为荣，强调这会使得Mongo跑得「更快」。

我感觉Hive都比他靠谱，不过别人干脆不染指OLTP

难道就没有些许优点了么，其实我一直都说的是其痛处

### js全栈支持
可以使用js操作后端数据库，对Node党来说还是挺有Bigger的

### 与Big Data的结合
在Hadoop上更好的支持，可以说更好的故事，但这其实是OLAP的故事

### MongoFS
如果你已经使用了MongoDB，这是买一送一顺带的，实现得还不错，TB级的数据还是没问题的，放心用吧。


  [1]: http://coolshell.cn/articles/5826.html "千万别用MongoDB？"
  [2]: http://cookbook.mongodb.org/patterns/perform-two-phase-commits/ "Perform Two Phase Commits"
  
